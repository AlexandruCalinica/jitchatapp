@import "tailwindcss";

html, body, #root {
  height: 100%;
  margin: 0;
  font-family: "Barlow Semi Condensed", sans-serif;
}

@theme {
  /* --- Zed Core Palette --- */
  --color-zed-bg: light-dark(#fafafa, #282c34);
  --color-zed-sidebar: light-dark(#f2f2f2, #21252b);
  --color-zed-panel: light-dark(#e5e5e6, #181a1f);
  --color-zed-active: light-dark(#e8e8e8, #2c313a);

  /* --- Typography & Borders --- */
  --color-zed-fg: light-dark(#383a42, #dcdfe4);
  --color-zed-muted: light-dark(#696c77, #abb2bf);
  --color-zed-border: light-dark(#d0d0d0, #696c77);

  /* --- Zed Syntax Accents --- */
  --color-zed-blue: light-dark(#4078f2, #61afef);
  --color-zed-red: light-dark(#e45649, #e06c75);
  --color-zed-green: light-dark(#50a14f, #98c379);
  --color-zed-purple: light-dark(#a626a4, #c678dd);
  --color-zed-yellow: light-dark(#986801, #e5c07b);

  --color-gray-25: #f3f3f3;
  --color-gray-50: #efefef;
  --color-gray-100: #e5e5e5;
  --color-gray-200: #cfcfcf;
  --color-gray-300: #b6b6b6;
  --color-gray-400: #9e9e9e;
  --color-gray-500: #898989;
  --color-gray-600: #727272;
  --color-gray-700: #5c5c5c;
  --color-gray-800: #474747;
  --color-gray-900: #343434;
  --color-gray-950: #1d1d1d;

  --color-orange-50: #ffedeb;
  --color-orange-100: #ffdedb;
  --color-orange-200: #ffbcb5;
  --color-orange-300: #fe978b;
  --color-orange-400: #fe6d54;
  --color-orange-500: #ec4707;
  --color-orange-600: #bf3804;
  --color-orange-700: #912802;
  --color-orange-800: #661901;
  --color-orange-900: #3d0c00;
  --color-orange-950: #280500;

  --animate-pulseOpacity: pulseOpacity 1s ease-in-out infinite;
  @keyframes pulseOpacity {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 0.7;
    }
  }

  --animate-wave: wave 1s linear infinite;
  @keyframes wave {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  --animate-slideDownFade: slideDownAndFade 300ms ease-out;
  @keyframes slideDownAndFade {
    from {
      opacity: 0;
      transform: translateY(-2px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  --animate-slideLeftFade: slideLeftAndFade 300ms ease-out;
  @keyframes slideLeftAndFade {
    from {
      opacity: 0;
      transform: translateX(30%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  --animate-slideUpFade: slideUpAndFade 300ms ease-out;
  @keyframes slideUpAndFade {
    from {
      opacity: 0;
      transform: translateY(2px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  --animate-slideRightFade: slideRightAndFade 300ms ease-out;
  @keyframes slideRightAndFade {
    from {
      opacity: 0;
      transform: translateX(-2px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  --animate-slideOutLeftFade: slideOutLeftFade 400ms ease-in;
  @keyframes slideOutLeftFade {
    0% {
      opacity: 1;
      transform: translateX(0);
      width: 100%;
    }
    100% {
      opacity: 0;
      transform: translateX(-100%);
      width: 0%;
    }
  }

  --animate-slideInRightFade: slideInRightFade 400ms ease-out;
  @keyframes slideInRightFade {
    0% {
      opacity: 0;
      transform: translateX(-100%);
      width: 0%;
    }
    100% {
      opacity: 1;
      transform: translateX(0);
      width: 100%;
    }
  }

  --animate-overlayShow: overlayShow 200ms ease-out;
  @keyframes overlayShow {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  --animate-contentShowTop: contentShowTop 300ms ease-out;
  @keyframes contentShowTop {
    from {
      opacity: 0;
      transform: translateY(-5%) scale(0.96);
    }
    to {
      opacity: 1;
      transform: translateY(0%) scale(1);
    }
  }

  --animate-collapseDown: collapseDown 100ms ease-out;
  @keyframes collapseDown {
    from {
      height: 0;
      opacity: 0;
    }
    to {
      height: var(--radix-collapsible-content-height);
      opacity: 1;
    }
  }

  --animate-collapseUp: collapseUp 100ms ease-in;
  @keyframes collapseUp {
    from {
      height: var(--radix-collapsible-content-height);
      opacity: 1;
    }
    to {
      height: 0;
      opacity: 0;
    }
  }

  --animate-slideDown: slideDown 300ms ease-out;
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  --animate-slideUp: slideUp 300ms ease-out;
  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  --animate-fadeIn: fadeIn 300ms ease-out;
  @keyframes fadeIn {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }

  --animate-fadeOut: fadeOut 300ms ease-in;
  @keyframes fadeOut {
    0% {
      opacity: 1;
    }
    100% {
      opacity: 0;
    }
  }

  --animate-focus: focus 200ms ease-out;
  @keyframes focus {
    from {
      background: var(--color-primary-50);
    }
    to {
      background: transparent;
    }
  }

  --animate-slideLeft: slideLeft 300ms ease-out;
  @keyframes slideLeft {
    from {
      opacity: 0;
      transform: translateX(20%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  --animate-fadeOutFilteredGrayscale: fadeOutFilteredGrayscale 400ms ease-in;
  @keyframes fadeOutFilteredGrayscale {
    from {
      filter: grayscale(100%) blur(4px);
    }
    to {
      filter: grayscale(0%) blur(0px);
    }
  }

  --animate-commitFlash: commitFlash 300ms ease-out;
  @keyframes commitFlash {
    0% {
      border-left-color: var(--color-zed-blue);
    }
    40% {
      border-left-color: var(--color-zed-blue);
      box-shadow: 0 0 8px color-mix(in srgb, var(--color-zed-blue) 40%, transparent);
    }
    100% {
      border-left-color: var(--color-zed-blue);
      box-shadow: none;
    }
  }

  --animate-timestampFadeIn: timestampFadeIn 250ms ease-out;
  @keyframes timestampFadeIn {
    from {
      opacity: 0;
      transform: translateX(4px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
}

p[data-user] {
  position: relative;
  padding-left: 48px;
  padding-top: 4px;
  padding-bottom: 4px;
  /*border-left: 3px solid var(--color-zed-border);*/
  transition: border-color 0.2s ease, background-color 0.2s ease;

  &::after {
    content: "@" attr(data-user);
    display: inline-block;
    position: absolute;
    top: 4px;
    right: 4px;
    font-size: 12px;
    font-weight: 400;
    color: var(--color-zed-muted);
  }

  &::before {
    content: "";
    display: inline-block;
    position: absolute;
    top: 6px;
    left: 16px;
    width: 20px;
    height: 20px;
    background-image: var(--avatar-url);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border-radius: 100%;
  }
}

p[data-user][data-draft="true"] {
  /*border-left: 3px dashed var(--color-zed-muted);*/
  background-color: var(--color-zed-sidebar);

  &::after {
    content: "@" attr(data-user) " · drafting...";
    color: var(--color-zed-muted);
    font-style: italic;
  }
}

p[data-user][data-timestamp] {
  /*border-left: 3px solid var(--color-zed-blue);*/
  background-color: transparent;
  animation: commitFlash 300ms ease-out;

  &::after {
    content: "@" attr(data-user) " · " attr(data-time);
    color: var(--color-zed-muted);
    font-style: normal;
    animation: timestampFadeIn 250ms ease-out;
  }
}

p[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup) {
  filter: blur(3px);
  transition: filter 0.2s ease-in-out;
}

[data-peek] p[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup) {
  filter: none;
}

/* Blockquote styles */
blockquote[data-user] {
  position: relative;
  padding-left: 36px;
  padding-top: 4px;
  padding-bottom: 4px;
  border-left: 3px solid var(--color-zed-border);
  margin-left: 4px;
  margin-top: 0;
  margin-bottom: 0;
  font-style: italic;
  color: var(--color-zed-muted);
  transition: border-color 0.2s ease, background-color 0.2s ease;

  &::after {
    content: "@" attr(data-user);
    display: inline-block;
    position: absolute;
    top: 8px;
    right: 4px;
    font-size: 10px;
    font-weight: 400;
    color: var(--color-zed-muted);
    font-style: normal;
  }

  &::before {
    content: "";
    display: inline-block;
    position: absolute;
    top: 4px;
    left: 4px;
    width: 24px;
    height: 24px;
    background-image: var(--avatar-url);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border-radius: 4px;
  }
}

blockquote[data-user][data-draft="true"] {
  /*border-left: 3px dashed var(--color-zed-muted);*/
  background-color: var(--color-zed-sidebar);

  &::after {
    content: "@" attr(data-user) " · drafting...";
    color: var(--color-zed-muted);
    font-style: normal;
  }
}

blockquote[data-user][data-timestamp] {
  /*border-left: 3px solid var(--color-zed-blue);*/
  background-color: transparent;
  animation: commitFlash 300ms ease-out;

  &::after {
    content: "@" attr(data-user) " · " attr(data-time);
    color: var(--color-zed-muted);
    font-style: normal;
    animation: timestampFadeIn 250ms ease-out;
  }
}

blockquote[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup) {
  filter: blur(3px);
  transition: filter 0.2s ease-in-out;
}

[data-peek] blockquote[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup) {
  filter: none;
}

/* List container styles - message block with avatar */
ul[data-user],
ol[data-user] {
  position: relative;
  padding-left: 36px;
  padding-top: 4px;
  padding-bottom: 4px;
  /*border-left: 3px solid var(--color-zed-border);*/
  margin-left: 4px;
  margin-bottom: 0;
  transition: border-color 0.2s ease, background-color 0.2s ease;

  &::after {
    content: "@" attr(data-user);
    display: inline-block;
    position: absolute;
    top: 8px;
    right: 4px;
    font-size: 10px;
    font-weight: 400;
    color: var(--color-zed-muted);
  }

  &::before {
    content: "";
    display: inline-block;
    position: absolute;
    top: 4px;
    left: 4px;
    width: 24px;
    height: 24px;
    background-image: var(--avatar-url);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border-radius: 4px;
  }
}

ul[data-user][data-draft="true"],
ol[data-user][data-draft="true"] {
  /*border-left: 3px dashed var(--color-zed-muted);*/
  background-color: var(--color-zed-sidebar);

  &::after {
    content: "@" attr(data-user) " · drafting...";
    color: var(--color-zed-muted);
    font-style: italic;
  }
}

ul[data-user][data-timestamp],
ol[data-user][data-timestamp] {
  /*border-left: 3px solid var(--color-zed-blue);*/
  background-color: transparent;
  animation: commitFlash 300ms ease-out;

  &::after {
    content: "@" attr(data-user) " · " attr(data-time);
    color: var(--color-zed-muted);
    font-style: normal;
    animation: timestampFadeIn 250ms ease-out;
  }
}

ul[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup),
ol[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup) {
  filter: blur(3px);
  transition: filter 0.2s ease-in-out;
}

[data-peek] ul[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup),
[data-peek] ol[data-user][data-draft="true"]:not([data-own]) :is(span, strong, em, u, s, code, mark, sub, sup) {
  filter: none;
}

/* List item styles - nested content, no individual avatar */
li[data-user] {
  margin-left: 16px;
}

span[data-user]:has(> div > img) {
  display: block;
  margin: 4px 0;
  padding: 0;
  border: none;
  background: none;
}

span[data-user]:has(> div > img)::before,
span[data-user]:has(> div > img)::after {
  display: none;
}

span[data-user][data-draft="true"]:not([data-own]):has(> div > img) img {
  filter: blur(8px);
  transition: filter 0.2s ease-in-out;
}

[data-peek] span[data-user][data-draft="true"]:not([data-own]):has(> div > img) img {
  filter: none;
}
